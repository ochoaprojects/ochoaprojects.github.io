<!DOCTYPE html><html lang="en" ><head><meta http-equiv="Content-Type" content="text/html; charset=UTF-8"><meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no"><meta name="generator" content="Jekyll v4.2.2" /><meta property="og:title" content="Automating AWS VPC and EC2 Instances using Terraform" /><meta property="og:locale" content="en" /><meta name="description" content="Terraform is a powerful tool that allows us to automate infrastructure in our cloud providers and much more. Using terraform to automate the building and configuration of our AWS enviornment to be in the exact state we want it to be is not only a huge time saver, but also ensures we are not making a mistake each time we deploy it." /><meta property="og:description" content="Terraform is a powerful tool that allows us to automate infrastructure in our cloud providers and much more. Using terraform to automate the building and configuration of our AWS enviornment to be in the exact state we want it to be is not only a huge time saver, but also ensures we are not making a mistake each time we deploy it." /><link rel="canonical" href="https://ochoaprojects.github.io/posts/TerraformWithAWS/" /><meta property="og:url" content="https://ochoaprojects.github.io/posts/TerraformWithAWS/" /><meta property="og:site_name" content="OchoaProjects" /><meta property="og:type" content="article" /><meta property="article:published_time" content="2022-06-28T10:00:00-07:00" /><meta name="twitter:card" content="summary" /><meta property="twitter:title" content="Automating AWS VPC and EC2 Instances using Terraform" /><meta name="twitter:site" content="@twitter_username" /> <script type="application/ld+json"> {"@context":"https://schema.org","@type":"BlogPosting","dateModified":"2022-07-01T00:53:48-07:00","datePublished":"2022-06-28T10:00:00-07:00","description":"Terraform is a powerful tool that allows us to automate infrastructure in our cloud providers and much more. Using terraform to automate the building and configuration of our AWS enviornment to be in the exact state we want it to be is not only a huge time saver, but also ensures we are not making a mistake each time we deploy it.","headline":"Automating AWS VPC and EC2 Instances using Terraform","mainEntityOfPage":{"@type":"WebPage","@id":"https://ochoaprojects.github.io/posts/TerraformWithAWS/"},"url":"https://ochoaprojects.github.io/posts/TerraformWithAWS/"}</script><title>Automating AWS VPC and EC2 Instances using Terraform | OchoaProjects</title><link rel="apple-touch-icon" sizes="180x180" href="/assets/img/favicons/apple-touch-icon.png"><link rel="icon" type="image/png" sizes="32x32" href="/assets/img/favicons/favicon-32x32.png"><link rel="icon" type="image/png" sizes="16x16" href="/assets/img/favicons/favicon-16x16.png"><link rel="manifest" href="/assets/img/favicons/site.webmanifest"><link rel="shortcut icon" href="/assets/img/favicons/favicon.ico"><meta name="apple-mobile-web-app-title" content="OchoaProjects"><meta name="application-name" content="OchoaProjects"><meta name="msapplication-TileColor" content="#da532c"><meta name="msapplication-config" content="/assets/img/favicons/browserconfig.xml"><meta name="theme-color" content="#ffffff"><link rel="preconnect" href="https://fonts.googleapis.com" ><link rel="dns-prefetch" href="https://fonts.googleapis.com" ><link rel="preconnect" href="https://fonts.gstatic.com" crossorigin><link rel="dns-prefetch" href="https://fonts.gstatic.com" crossorigin><link rel="preconnect" href="https://fonts.googleapis.com" ><link rel="dns-prefetch" href="https://fonts.googleapis.com" ><link rel="preconnect" href="https://cdn.jsdelivr.net" ><link rel="dns-prefetch" href="https://cdn.jsdelivr.net" ><link rel="stylesheet" href="https://fonts.googleapis.com/css2?family=Lato&family=Source+Sans+Pro:wght@400;600;700;900&display=swap"><link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/bootstrap@4/dist/css/bootstrap.min.css"><link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/@fortawesome/fontawesome-free@5.11.2/css/all.min.css"><link rel="stylesheet" href="/assets/css/style.css"><link rel="stylesheet" href="https://cdn.jsdelivr.net/gh/afeld/bootstrap-toc@1.0.1/dist/bootstrap-toc.min.css"><link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/magnific-popup@1/dist/magnific-popup.min.css"> <script src="https://cdn.jsdelivr.net/npm/jquery@3/dist/jquery.min.js"></script> <script type="text/javascript"> class ModeToggle { static get MODE_KEY() { return "mode"; } static get MODE_ATTR() { return "data-mode"; } static get DARK_MODE() { return "dark"; } static get LIGHT_MODE() { return "light"; } static get ID() { return "mode-toggle"; } constructor() { if (this.hasMode) { if (this.isDarkMode) { if (!this.isSysDarkPrefer) { this.setDark(); } } else { if (this.isSysDarkPrefer) { this.setLight(); } } } let self = this; /* always follow the system prefers */ this.sysDarkPrefers.addEventListener("change", () => { if (self.hasMode) { if (self.isDarkMode) { if (!self.isSysDarkPrefer) { self.setDark(); } } else { if (self.isSysDarkPrefer) { self.setLight(); } } self.clearMode(); } self.notify(); }); } /* constructor() */ get sysDarkPrefers() { return window.matchMedia("(prefers-color-scheme: dark)"); } get isSysDarkPrefer() { return this.sysDarkPrefers.matches; } get isDarkMode() { return this.mode === ModeToggle.DARK_MODE; } get isLightMode() { return this.mode === ModeToggle.LIGHT_MODE; } get hasMode() { return this.mode != null; } get mode() { return sessionStorage.getItem(ModeToggle.MODE_KEY); } /* get the current mode on screen */ get modeStatus() { if (this.isDarkMode || (!this.hasMode && this.isSysDarkPrefer)) { return ModeToggle.DARK_MODE; } else { return ModeToggle.LIGHT_MODE; } } setDark() { $('html').attr(ModeToggle.MODE_ATTR, ModeToggle.DARK_MODE); sessionStorage.setItem(ModeToggle.MODE_KEY, ModeToggle.DARK_MODE); } setLight() { $('html').attr(ModeToggle.MODE_ATTR, ModeToggle.LIGHT_MODE); sessionStorage.setItem(ModeToggle.MODE_KEY, ModeToggle.LIGHT_MODE); } clearMode() { $('html').removeAttr(ModeToggle.MODE_ATTR); sessionStorage.removeItem(ModeToggle.MODE_KEY); } /* Notify another plugins that the theme mode has changed */ notify() { window.postMessage({ direction: ModeToggle.ID, message: this.modeStatus }, "*"); } } /* ModeToggle */ const toggle = new ModeToggle(); function flipMode() { if (toggle.hasMode) { if (toggle.isSysDarkPrefer) { if (toggle.isLightMode) { toggle.clearMode(); } else { toggle.setLight(); } } else { if (toggle.isDarkMode) { toggle.clearMode(); } else { toggle.setDark(); } } } else { if (toggle.isSysDarkPrefer) { toggle.setLight(); } else { toggle.setDark(); } } toggle.notify(); } /* flipMode() */ </script><body data-spy="scroll" data-target="#toc" data-topbar-visible="true"><div id="sidebar" class="d-flex flex-column align-items-end"><div class="profile-wrapper text-center"><div id="avatar"> <a href="/" class="mx-auto"> <img src="/project-assets/Brandon-Ochoa-Github.jpeg" alt="avatar" onerror="this.style.display='none'"> </a></div><div class="site-title mt-3"> <a href="/">OchoaProjects</a></div><div class="site-subtitle font-italic">A place where I post my projects and things that I am learning or working on.</div></div><ul class="w-100"><li class="nav-item"> <a href="/" class="nav-link"> <i class="fa-fw fas fa-home ml-xl-3 mr-xl-3 unloaded"></i> <span>HOME</span> </a><li class="nav-item"> <a href="/categories/" class="nav-link"> <i class="fa-fw fas fa-stream ml-xl-3 mr-xl-3 unloaded"></i> <span>CATEGORIES</span> </a><li class="nav-item"> <a href="/tags/" class="nav-link"> <i class="fa-fw fas fa-tag ml-xl-3 mr-xl-3 unloaded"></i> <span>TAGS</span> </a><li class="nav-item"> <a href="/archives/" class="nav-link"> <i class="fa-fw fas fa-archive ml-xl-3 mr-xl-3 unloaded"></i> <span>ARCHIVES</span> </a><li class="nav-item"> <a href="/about/" class="nav-link"> <i class="fa-fw fas fa-info-circle ml-xl-3 mr-xl-3 unloaded"></i> <span>ABOUT</span> </a></ul><div class="sidebar-bottom mt-auto d-flex flex-wrap justify-content-center align-items-center"> <button class="mode-toggle btn" aria-label="Switch Mode"> <i class="fas fa-adjust"></i> </button> <span class="icon-border"></span> <a href="https://github.com/ochoaprojects" aria-label="github" target="_blank" rel="noopener"> <i class="fab fa-github"></i> </a> <a href="https://www.linkedin.com/in/brandon-ochoa/" aria-label="linkedin" target="_blank" rel="noopener"> <i class="fab fa-linkedin"></i> </a> <a href="https://www.youtube.com/@ochoaprojects9930" aria-label="youtube" target="_blank" rel="noopener"> <i class="fab fa-youtube"></i> </a> <a href=" javascript:location.href = 'mailto:' + ['brandon','ochoaprojects.com'].join('@')" aria-label="email" > <i class="fas fa-envelope"></i> </a> <a href="/feed.xml" aria-label="rss" > <i class="fas fa-rss"></i> </a></div></div><div id="topbar-wrapper"><div id="topbar" class="container d-flex align-items-center justify-content-between h-100 pl-3 pr-3 pl-md-4 pr-md-4"> <span id="breadcrumb"> <span> <a href="/"> Home </a> </span> <span>Automating AWS VPC and EC2 Instances using Terraform</span> </span> <i id="sidebar-trigger" class="fas fa-bars fa-fw"></i><div id="topbar-title"> Post</div><i id="search-trigger" class="fas fa-search fa-fw"></i> <span id="search-wrapper" class="align-items-center"> <i class="fas fa-search fa-fw"></i> <input class="form-control" id="search-input" type="search" aria-label="search" autocomplete="off" placeholder="Search..."> </span> <span id="search-cancel" >Cancel</span></div></div><div id="main-wrapper" class="d-flex justify-content-center"><div id="main" class="container pl-xl-4 pr-xl-4"><div class="row"><div id="core-wrapper" class="col-12 col-lg-11 col-xl-9 pr-xl-4"><div class="post pl-1 pr-1 pl-md-2 pr-md-2"><h1 data-toc-skip>Automating AWS VPC and EC2 Instances using Terraform</h1><div class="post-meta text-muted"> <span> Posted <em class="" data-ts="1656435600" data-df="ll" data-toggle="tooltip" data-placement="bottom"> Jun 28, 2022 </em> </span> <span> Updated <em class="" data-ts="1656662028" data-df="ll" data-toggle="tooltip" data-placement="bottom"> Jul 1, 2022 </em> </span><div class="d-flex justify-content-between"> <span> By <em> <a href="https://github.com/ochoaprojects">Brandon Ochoa</a> </em> </span><div> <span class="readtime" data-toggle="tooltip" data-placement="bottom" title="3574 words"> <em>19 min</em> read</span></div></div></div><div class="post-content"><p>Terraform is a powerful tool that allows us to automate infrastructure in our cloud providers and much more. Using terraform to automate the building and configuration of our AWS enviornment to be in the exact state we want it to be is not only a huge time saver, but also ensures we are not making a mistake each time we deploy it.</p><h2 id="table-of-contents"><span class="mr-2">Table of Contents</span><a href="#table-of-contents" class="anchor text-muted"><i class="fas fa-hashtag"></i></a></h2><ul><li><a href="#starting-our-project-and-setting-a-provider">Starting our project and setting a provider</a><li><a href="#create-a-key-pair">Create a Key Pair</a><li><a href="#create-vpc">Create VPC</a><li><a href="#create-internet-gateway">Create Internet Gateway</a><li><a href="#create-a-subnet">Create a Subnet</a><li><a href="#create-custom-route-table">Create Custom Route Table</a><li><a href="#associate-subnet-with-route-table">Associate Subnet with Route Table</a><li><a href="#create-security-group-to-allow-port-web-traffic-and-ssh">Create Security Group to Allow Port Web Traffic and SSH</a><li><a href="#create-a-network-interface-with-an-ip-in-the-subnet">Create a Network Interface with an IP in the Subnet</a><li><a href="#assign-an-elastic-ip-to-the-network-interface">Assign an Elastic IP to the Network Interface</a><li><a href="#create-debian-server-then-install-and-enable-apache2">Create Debian Server then Install and Enable Apache2</a><li><a href="#terraform-plan">Terraform Plan</a><li><a href="#terraform-apply">Terraform Apply</a><li><a href="#checking-the-results">Checking the Results</a><li><a href="#terraform-destory">Terraform Destory</a><li><a href="#completed-maintf-file">Completed main.tf File</a><ul><li><a href="#maintf">main.tf</a></ul></ul><h1 id="starting-our-project-and-setting-a-provider">Starting our project and setting a provider</h1><p>Terraform uses <code class="language-plaintext highlighter-rouge">.tf</code> files. We will start off by creating our <code class="language-plaintext highlighter-rouge">main.tf</code> file.</p><div class="language-bash highlighter-rouge"><div class="code-header"> <span data-label-text="Shell"><i class="fas fa-code small"></i></span> <button aria-label="copy" data-title-succeed="Copied!"><i class="far fa-clipboard"></i></button></div><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
</pre><td class="rouge-code"><pre><span class="nb">touch </span>main.tf
</pre></table></code></div></div><blockquote class="prompt-tip"><div><p>Note: Putting all code in main.tf is a good idea when you are getting started or writing an example code. In all other cases you will be better having several files split logically like this:</p><ul><li><code class="language-plaintext highlighter-rouge">main.tf</code> - call modules, locals, and data sources to create all resources<li><code class="language-plaintext highlighter-rouge">variables.tf</code> - contains declarations of variables used in main.tf<li><code class="language-plaintext highlighter-rouge">outputs.tf</code> - contains outputs from the resources created in main.tf<li><code class="language-plaintext highlighter-rouge">versions.tf</code> - contains version requirements for Terraform and providers<li><code class="language-plaintext highlighter-rouge">terraform.tfvars</code> should not be used anywhere except <a href="https://www.terraform-best-practices.com/key-concepts#composition">composition</a>.</ul></div></blockquote><blockquote class="prompt-tip"><div><p>To learn more of the best practices visit the <a href="https://www.terraform-best-practices.com/code-structure">Terraform Best Practices Website</a></p></div></blockquote><p>We will need to setup up our provider on the machine we will be running our terraform code on. In this case it will be AWS. To set our provider we use the following block:</p><div class="language-terraform highlighter-rouge"><div class="code-header"> <span data-label-text="Terraform"><i class="fas fa-code small"></i></span> <button aria-label="copy" data-title-succeed="Copied!"><i class="far fa-clipboard"></i></button></div><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
4
5
</pre><td class="rouge-code"><pre><span class="k">provider</span> <span class="s2">"aws"</span> <span class="p">{</span>
  <span class="nx">region</span> <span class="p">=</span> <span class="s2">"us-east-1"</span>
  <span class="nx">access_key</span> <span class="p">=</span> <span class="s2">"&lt;YOUR-ACCESS-KEY&gt;"</span>
  <span class="nx">secret_key</span> <span class="p">=</span> <span class="s2">"&lt;YOUR-SECRET-KEY&gt;"</span>
<span class="p">}</span>
</pre></table></code></div></div><blockquote class="prompt-danger"><div><p>Danger: It is best to use a secret vault for credential based values instead of placing them directly into your <code class="language-plaintext highlighter-rouge">.tf</code> file like this. For the sake of this example, we will continue as is</p></div></blockquote><p>Please choose the region of your choice. In this example I am using <code class="language-plaintext highlighter-rouge">us-east-1</code>. To obtain your <code class="language-plaintext highlighter-rouge">access_key</code> and <code class="language-plaintext highlighter-rouge">secret_key</code> from the AWS console, start by heading to the “Security credentials” from the top right hand corner after clicking your username.</p><p><img data-src="/project-assets/TerraformWithAWS/security-credentials-option.png" alt="Security Credentials" data-proofer-ignore></p><p>Scroll down to the Access Keys section of the page and click “Create access key”</p><p><img data-src="/project-assets/TerraformWithAWS/create-access-key.png" alt="Create Access Key" data-proofer-ignore></p><p>Once your access key has been created, make note of your “Access key ID”. Click on the “show secret” button and also make note of your “Secret access key”.</p><p><img data-src="/project-assets/TerraformWithAWS/access-key-created.png" alt="Access Key Is Created" data-proofer-ignore></p><p>Now would be a good time to initialize our provider on our machine with Terraform by using the following command:</p><div class="language-bash highlighter-rouge"><div class="code-header"> <span data-label-text="Shell"><i class="fas fa-code small"></i></span> <button aria-label="copy" data-title-succeed="Copied!"><i class="far fa-clipboard"></i></button></div><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
</pre><td class="rouge-code"><pre>terraform init
</pre></table></code></div></div><p>After running the init command, you will see the following output:</p><div class="language-plaintext highlighter-rouge"><div class="code-header"> <span data-label-text="Plaintext"><i class="fas fa-code small"></i></span> <button aria-label="copy" data-title-succeed="Copied!"><i class="far fa-clipboard"></i></button></div><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
4
5
6
7
8
9
10
11
12
13
14
15
16
17
18
19
20
21
22
</pre><td class="rouge-code"><pre>Initializing the backend...

Initializing provider plugins...
- Finding latest version of hashicorp/aws...
- Installing hashicorp/aws v4.20.1...
- Installed hashicorp/aws v4.20.1 (signed by HashiCorp)

Terraform has created a lock file .terraform.lock.hcl to record the provider
selections it made above. Include this file in your version control repository
so that Terraform can guarantee to make the same selections by default when
you run "terraform init" in the future.

Terraform has been successfully initialized!

You may now begin working with Terraform. Try running "terraform plan" to see
any changes that are required for your infrastructure. All Terraform commands
should now work.

If you ever set or change modules or backend configuration for Terraform,
rerun this command to reinitialize your working directory. If you forget, other
commands will detect it and remind you to do so if necessary.

</pre></table></code></div></div><h1 id="create-a-key-pair">Create a Key Pair</h1><p>For this project, we will be standing up an EC2 instance. AWS requires us to create key pairs so that we can connect to our EC2 instance. To do this, start by heading over to the EC2 service in the AWS console. Next click on <code class="language-plaintext highlighter-rouge">Key Pairs</code> on the left hand panel and then <code class="language-plaintext highlighter-rouge">Create a Key Pair</code> in the top right hand corner.</p><p><img data-src="/project-assets/TerraformWithAWS/create-key-pair.png" alt="Create Key Pair" data-proofer-ignore></p><p>Next up we need to give our key pair a name and choose a file format. I would personally choose the <code class="language-plaintext highlighter-rouge">pem</code> format because it already works with both Mac and Linux, and converting it to a <code class="language-plaintext highlighter-rouge">ppk</code> format later is easy if you want to use it with Windows. Once you click “Create Key Pair” it will automatically download for you.</p><p><img data-src="/project-assets/TerraformWithAWS/create-key-pair-options.png" alt="Create Key Pair Options" data-proofer-ignore></p><h1 id="create-vpc">Create VPC</h1><p>From here on the theme of terraform will be to define AWS resources and specifying the details on what we want that resource to be once created. The <code class="language-plaintext highlighter-rouge">cidr_block</code> is going to be the network we are going to define now. Later on we will be making subnets within this network CIDR (Classless Internet Domain Routing). The naming being used in these resources could be anything, but for these examples I will be using “prod” or “production”.</p><div class="language-terraform highlighter-rouge"><div class="code-header"> <span data-label-text="Terraform"><i class="fas fa-code small"></i></span> <button aria-label="copy" data-title-succeed="Copied!"><i class="far fa-clipboard"></i></button></div><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
4
5
6
7
</pre><td class="rouge-code"><pre><span class="k">resource</span> <span class="s2">"aws_vpc"</span> <span class="s2">"prod-vpc"</span> <span class="p">{</span>
  <span class="nx">cidr_block</span>       <span class="p">=</span> <span class="s2">"10.0.0.0/16"</span>
  <span class="nx">instance_tenancy</span> <span class="p">=</span> <span class="s2">"default"</span>
  <span class="nx">tags</span> <span class="p">=</span> <span class="p">{</span>
    <span class="nx">Name</span> <span class="p">=</span> <span class="s2">"production"</span>
  <span class="p">}</span>
<span class="p">}</span>
</pre></table></code></div></div><h1 id="create-internet-gateway">Create Internet Gateway</h1><p>Now that we have already added a resouce to this terraform file, we are going to start seeing another theme surface which will be attaching new resources referrencing prior resources. The beggining of that theme starts here when we define our <code class="language-plaintext highlighter-rouge">internet gateway</code>. We want this gateway to be attached to the VPC we just made, so we use the following format of <code class="language-plaintext highlighter-rouge">aws_vpc.prod-vpc.id</code>.</p><div class="language-terraform highlighter-rouge"><div class="code-header"> <span data-label-text="Terraform"><i class="fas fa-code small"></i></span> <button aria-label="copy" data-title-succeed="Copied!"><i class="far fa-clipboard"></i></button></div><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
</pre><td class="rouge-code"><pre><span class="k">resource</span> <span class="s2">"aws_internet_gateway"</span> <span class="s2">"gw"</span> <span class="p">{</span>
  <span class="nx">vpc_id</span> <span class="p">=</span> <span class="nx">aws_vpc</span><span class="p">.</span><span class="nx">prod</span><span class="err">-</span><span class="nx">vpc</span><span class="p">.</span><span class="nx">id</span>
<span class="p">}</span>
</pre></table></code></div></div><h1 id="create-a-subnet">Create a Subnet</h1><p>So from the network of <code class="language-plaintext highlighter-rouge">10.0.0.0/16</code> we created in the original VPC definition, we will create a subnet within that network. The network we will create for this example will be <code class="language-plaintext highlighter-rouge">10.0.1.0/24</code>. We attach it to the VPC using the aws vpc id again.</p><div class="language-terraform highlighter-rouge"><div class="code-header"> <span data-label-text="Terraform"><i class="fas fa-code small"></i></span> <button aria-label="copy" data-title-succeed="Copied!"><i class="far fa-clipboard"></i></button></div><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
4
5
6
7
8
9
</pre><td class="rouge-code"><pre><span class="k">resource</span> <span class="s2">"aws_subnet"</span> <span class="s2">"subnet-1"</span> <span class="p">{</span>
  <span class="nx">vpc_id</span>     <span class="p">=</span> <span class="nx">aws_vpc</span><span class="p">.</span><span class="nx">prod</span><span class="err">-</span><span class="nx">vpc</span><span class="p">.</span><span class="nx">id</span>
  <span class="nx">cidr_block</span> <span class="p">=</span> <span class="s2">"10.0.1.0/24"</span>
  <span class="nx">availability_zone</span> <span class="p">=</span> <span class="s2">"us-east-1a"</span>
  
  <span class="nx">tags</span> <span class="p">=</span> <span class="p">{</span>
    <span class="nx">Name</span> <span class="p">=</span> <span class="s2">"prod-subnet"</span>
  <span class="p">}</span>
<span class="p">}</span>
</pre></table></code></div></div><h1 id="create-custom-route-table">Create Custom Route Table</h1><p>Once again we are going to give this resource a name. We are going to attach the route table to our VPC with the same syntax as we used for the internet gateway. Finally, we label the tag. What we are creating here is a default gate in the route table. To set the default gateway, we use the “quad zero” subnet by using <code class="language-plaintext highlighter-rouge">0.0.0.0/0</code>. This default route will send all IPv4 traffic to our to our gateway. The same thing is configured for IPv6, but instead of using the “quad zero,” we will represent this in the IPv6 equivalent which is <code class="language-plaintext highlighter-rouge">::/0</code>. Again, this will route all IPv6 traffic to our gateway. At this point you would think this is where we would attach our subnet and route table together, but that is not the case. Rather, we will use another AWS resource called “Route Table Association” in the next section.</p><div class="language-terraform highlighter-rouge"><div class="code-header"> <span data-label-text="Terraform"><i class="fas fa-code small"></i></span> <button aria-label="copy" data-title-succeed="Copied!"><i class="far fa-clipboard"></i></button></div><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
4
5
6
7
8
9
10
11
12
13
14
15
16
17
</pre><td class="rouge-code"><pre><span class="k">resource</span> <span class="s2">"aws_route_table"</span> <span class="s2">"prod-route-table"</span> <span class="p">{</span>
  <span class="nx">vpc_id</span> <span class="p">=</span> <span class="nx">aws_vpc</span><span class="p">.</span><span class="nx">prod</span><span class="err">-</span><span class="nx">vpc</span><span class="p">.</span><span class="nx">id</span>

  <span class="nx">route</span> <span class="p">{</span>
    <span class="nx">cidr_block</span> <span class="p">=</span> <span class="s2">"0.0.0.0/0"</span>
    <span class="nx">gateway_id</span> <span class="p">=</span> <span class="nx">aws_internet_gateway</span><span class="p">.</span><span class="nx">gw</span><span class="p">.</span><span class="nx">id</span>
  <span class="p">}</span>

  <span class="nx">route</span> <span class="p">{</span>
    <span class="nx">ipv6_cidr_block</span>        <span class="p">=</span> <span class="s2">"::/0"</span>
    <span class="nx">gateway_id</span> <span class="p">=</span> <span class="nx">aws_internet_gateway</span><span class="p">.</span><span class="nx">gw</span><span class="p">.</span><span class="nx">id</span>
  <span class="p">}</span>

  <span class="nx">tags</span> <span class="p">=</span> <span class="p">{</span>
    <span class="nx">Name</span> <span class="p">=</span> <span class="s2">"production"</span>
  <span class="p">}</span>
<span class="p">}</span>
</pre></table></code></div></div><h1 id="associate-subnet-with-route-table">Associate Subnet with Route Table</h1><p>This resource is fairly self explanatory. We are going to use this to associate our subnet with our route table.</p><div class="language-terraform highlighter-rouge"><div class="code-header"> <span data-label-text="Terraform"><i class="fas fa-code small"></i></span> <button aria-label="copy" data-title-succeed="Copied!"><i class="far fa-clipboard"></i></button></div><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
4
</pre><td class="rouge-code"><pre><span class="k">resource</span> <span class="s2">"aws_route_table_association"</span> <span class="s2">"a"</span> <span class="p">{</span>
  <span class="nx">subnet_id</span>      <span class="p">=</span> <span class="nx">aws_subnet</span><span class="p">.</span><span class="nx">subnet</span><span class="err">-</span><span class="mi">1</span><span class="p">.</span><span class="nx">id</span>
  <span class="nx">route_table_id</span> <span class="p">=</span> <span class="nx">aws_route_table</span><span class="p">.</span><span class="nx">prod</span><span class="err">-</span><span class="nx">route</span><span class="err">-</span><span class="nx">table</span><span class="p">.</span><span class="nx">id</span>
<span class="p">}</span>
</pre></table></code></div></div><h1 id="create-security-group-to-allow-port-web-traffic-and-ssh">Create Security Group to Allow Port Web Traffic and SSH</h1><blockquote class="prompt-tip"><div><p>Warning: In this example project I am creating a web server that I want public facing and accessible for web traffic. I am also adding in SSH for connecting to the machine with remote access. For opening up ports in your AWS infrastructure, always have a reason and be mindful of the security risks you are exposing yourself to. This is just example.</p></div></blockquote><p>Security group ports are nearly the equivalent to the opening of ports on your firewall at home and doing port forwarding. Here we specify what ports that we want to allow traffic in from and out to our infrastructure. In this project the end result will be a web server, therefore we want to allow <code class="language-plaintext highlighter-rouge">HTTPS</code> (port 443) and <code class="language-plaintext highlighter-rouge">HTTP</code> (port 80) which is default web traffic. As we have done before, we are naming our resources, tagging them to be easily identifable when we are viewing from the AWS console, and attaching it to our VPC resource earlier defined. Since we are configuring incoming connections, we could limit the connections to only specific IPs or networks/subnets with the <code class="language-plaintext highlighter-rouge">cidr_blocks</code> and <code class="language-plaintext highlighter-rouge">ipv6_cidr_blocks</code>. Instead of limiting these connections, we want an entirely public facing result; therefor we will once again use the “quad zero” <code class="language-plaintext highlighter-rouge">0.0.0.0/0</code> and IPv6 equivalent <code class="language-plaintext highlighter-rouge">::/0</code>.</p><div class="language-terraform highlighter-rouge"><div class="code-header"> <span data-label-text="Terraform"><i class="fas fa-code small"></i></span> <button aria-label="copy" data-title-succeed="Copied!"><i class="far fa-clipboard"></i></button></div><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
4
5
6
7
8
9
10
11
12
13
14
15
16
17
18
19
20
21
22
23
24
25
26
27
28
29
30
31
32
33
34
35
36
37
38
39
40
41
42
43
44
</pre><td class="rouge-code"><pre><span class="k">resource</span> <span class="s2">"aws_security_group"</span> <span class="s2">"allow_web"</span> <span class="p">{</span>
  <span class="nx">name</span>        <span class="p">=</span> <span class="s2">"allow_web_traffic"</span>
  <span class="nx">description</span> <span class="p">=</span> <span class="s2">"Allow Web inbound traffic"</span>
  <span class="nx">vpc_id</span>      <span class="p">=</span> <span class="nx">aws_vpc</span><span class="p">.</span><span class="nx">prod</span><span class="err">-</span><span class="nx">vpc</span><span class="p">.</span><span class="nx">id</span>

  <span class="nx">ingress</span> <span class="p">{</span>
    <span class="nx">description</span>      <span class="p">=</span> <span class="s2">"HTTP"</span>
    <span class="nx">from_port</span>        <span class="p">=</span> <span class="mi">80</span>
    <span class="nx">to_port</span>          <span class="p">=</span> <span class="mi">80</span>
    <span class="nx">protocol</span>         <span class="p">=</span> <span class="s2">"tcp"</span>
    <span class="nx">cidr_blocks</span>      <span class="p">=</span> <span class="p">[</span><span class="s2">"0.0.0.0/0"</span><span class="p">]</span>
    <span class="nx">ipv6_cidr_blocks</span> <span class="p">=</span> <span class="p">[</span><span class="s2">"::/0"</span><span class="p">]</span>
  <span class="p">}</span>

<span class="nx">ingress</span> <span class="p">{</span>
    <span class="nx">description</span>      <span class="p">=</span> <span class="s2">"HTTPS"</span>
    <span class="nx">from_port</span>        <span class="p">=</span> <span class="mi">443</span>
    <span class="nx">to_port</span>          <span class="p">=</span> <span class="mi">443</span>
    <span class="nx">protocol</span>         <span class="p">=</span> <span class="s2">"tcp"</span>
    <span class="nx">cidr_blocks</span>      <span class="p">=</span> <span class="p">[</span><span class="s2">"0.0.0.0/0"</span><span class="p">]</span>
    <span class="nx">ipv6_cidr_blocks</span> <span class="p">=</span> <span class="p">[</span><span class="s2">"::/0"</span><span class="p">]</span>
  <span class="p">}</span>

<span class="nx">ingress</span> <span class="p">{</span>
    <span class="nx">description</span>      <span class="p">=</span> <span class="s2">"SSH"</span>
    <span class="nx">from_port</span>        <span class="p">=</span> <span class="mi">22</span>
    <span class="nx">to_port</span>          <span class="p">=</span> <span class="mi">22</span>
    <span class="nx">protocol</span>         <span class="p">=</span> <span class="s2">"tcp"</span>
    <span class="nx">cidr_blocks</span>      <span class="p">=</span> <span class="p">[</span><span class="s2">"0.0.0.0/0"</span><span class="p">]</span>
    <span class="nx">ipv6_cidr_blocks</span> <span class="p">=</span> <span class="p">[</span><span class="s2">"::/0"</span><span class="p">]</span>
  <span class="p">}</span>

  <span class="nx">egress</span> <span class="p">{</span>
    <span class="nx">from_port</span>        <span class="p">=</span> <span class="mi">0</span>
    <span class="nx">to_port</span>          <span class="p">=</span> <span class="mi">0</span>
    <span class="nx">protocol</span>         <span class="p">=</span> <span class="s2">"-1"</span>
    <span class="nx">cidr_blocks</span>      <span class="p">=</span> <span class="p">[</span><span class="s2">"0.0.0.0/0"</span><span class="p">]</span>
    <span class="nx">ipv6_cidr_blocks</span> <span class="p">=</span> <span class="p">[</span><span class="s2">"::/0"</span><span class="p">]</span>
  <span class="p">}</span>

  <span class="nx">tags</span> <span class="p">=</span> <span class="p">{</span>
    <span class="nx">Name</span> <span class="p">=</span> <span class="s2">"allow_web_also_ssh"</span>
  <span class="p">}</span>
<span class="p">}</span>
</pre></table></code></div></div><h1 id="create-a-network-interface-with-an-ip-in-the-subnet">Create a Network Interface with an IP in the Subnet</h1><p>So we have a lot of the networking set up at this point. We want to setup an IP that we are going to be using in this subnet with a NIC that we can later attach to an EC2 instance for our webserver. As always he call in the AWS resource we will use, network interface in this case, and give it a name. Next we attach the nic to prior resouces we defined such as the subnet and security group. Additionally, we are going to go with the IP address of <code class="language-plaintext highlighter-rouge">10.0.1.50</code>.</p><div class="language-terraform highlighter-rouge"><div class="code-header"> <span data-label-text="Terraform"><i class="fas fa-code small"></i></span> <button aria-label="copy" data-title-succeed="Copied!"><i class="far fa-clipboard"></i></button></div><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
4
5
</pre><td class="rouge-code"><pre><span class="k">resource</span> <span class="s2">"aws_network_interface"</span> <span class="s2">"web-server-nic"</span> <span class="p">{</span>
  <span class="nx">subnet_id</span>       <span class="p">=</span> <span class="nx">aws_subnet</span><span class="p">.</span><span class="nx">subnet</span><span class="err">-</span><span class="mi">1</span><span class="p">.</span><span class="nx">id</span>
  <span class="nx">private_ips</span>     <span class="p">=</span> <span class="p">[</span><span class="s2">"10.0.1.50"</span><span class="p">]</span>
  <span class="nx">security_groups</span> <span class="p">=</span> <span class="p">[</span><span class="nx">aws_security_group</span><span class="p">.</span><span class="nx">allow_web</span><span class="p">.</span><span class="nx">id</span><span class="p">]</span>
<span class="p">}</span>
</pre></table></code></div></div><h1 id="assign-an-elastic-ip-to-the-network-interface">Assign an Elastic IP to the Network Interface</h1><p>If we were to spin up our EC2 instance right now as is, we would get an IP address for our subnet and networking would work. However, we want a little more control of this aspect in this project. To achieve the control we are looking for, we will set an <code class="language-plaintext highlighter-rouge">Elastic IP</code>. An Elastic IP address is a static public IPv4 address associated with your AWS account in a specific Region. Unlike an auto-assigned public IP address, an Elastic IP address is preserved after you stop and start your instance in a virtual private cloud (VPC).</p><blockquote class="prompt-tip"><div><p>Tip: The AWS Elastic IP relies on the deployment of the internet gateway. If you try to create this EIP in a VPC with no internet gateway then it will throw and error. The solution to this when using terraform is to specify the <code class="language-plaintext highlighter-rouge">depends_on</code> and specifying the <code class="language-plaintext highlighter-rouge">aws_internet_gateway.&lt;YOUR-RESOURCE-NAME&gt;</code>.</p></div></blockquote><div class="language-terraform highlighter-rouge"><div class="code-header"> <span data-label-text="Terraform"><i class="fas fa-code small"></i></span> <button aria-label="copy" data-title-succeed="Copied!"><i class="far fa-clipboard"></i></button></div><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
4
5
6
7
8
</pre><td class="rouge-code"><pre><span class="k">resource</span> <span class="s2">"aws_eip"</span> <span class="s2">"one"</span> <span class="p">{</span>
  <span class="nx">vpc</span>                       <span class="p">=</span> <span class="kc">true</span>
  <span class="nx">network_interface</span>         <span class="p">=</span> <span class="nx">aws_network_interface</span><span class="p">.</span><span class="nx">web</span><span class="err">-</span><span class="nx">server</span><span class="err">-</span><span class="nx">nic</span><span class="p">.</span><span class="nx">id</span>
  <span class="nx">associate_with_private_ip</span> <span class="p">=</span> <span class="s2">"10.0.1.50"</span>
  <span class="nx">depends_on</span> <span class="p">=</span> <span class="p">[</span>
    <span class="nx">aws_internet_gateway</span><span class="p">.</span><span class="nx">gw</span>
  <span class="p">]</span>
<span class="p">}</span>
</pre></table></code></div></div><h1 id="create-debian-server-then-install-and-enable-apache2">Create Debian Server then Install and Enable Apache2</h1><p>Finally we have our networking the way we want it. The fun part of creating our actual webserver is here! A big piece of this part is specifing the <code class="language-plaintext highlighter-rouge">AMI</code> (Amazon Machine Image). We want to use a Debian instance to house our web server and this can be done by finding the correct AMI ID. It’s important to check that the AMI ID you are choosing is correct because the AMI IDs supplied by Amazon are subject to change if you will be using theirs. To find the most up to date ID, open up the AWS console, then navigate to the EC2 service, click launch an instance from the top right hand corner of the screen, type “debian” in the search bar and press the enter key.</p><p><img data-src="/project-assets/TerraformWithAWS/search-debian-ami.png" alt="Search Debian AMIs" data-proofer-ignore></p><p>The results of AMIs supplied by amazon should appear with Amazon’s latest Debian version. Here is where you will see two AMI IDs. One is for the <code class="language-plaintext highlighter-rouge">x86</code> architecture while the other is an <code class="language-plaintext highlighter-rouge">ARM</code> architecture. We will be using the x86 for this project. On top of choosing the correct architecture, as always doing anything in the AWS console, make sure that you are doing all of these actions in the intended region you plan to deploy your infrastructure in. You can search for Debian in the Amazon catalog and the “correct” AMI will be the result. However, the AMI IDs are different for the same “Debian” across different regions.</p><blockquote class="prompt-tip"><div><p>Note: Choose the correct AMI ID!</p></div></blockquote><p><img data-src="/project-assets/TerraformWithAWS/select-the-debian-ami.png" alt="Copy the x86 AMI ID" data-proofer-ignore></p><p>Since this project is simply for going through the basics of terraform and we are only using a basic web server as an example, we do not need a lot of performance and power here. The free-tier instance type of <code class="language-plaintext highlighter-rouge">t2.micro</code> will be perfect for this situation. We will attach the key pair we made at the beggining of this post so that we can use the <code class="language-plaintext highlighter-rouge">.pem</code> file we downloaded earlier to now access the EC2 instance using SSH and remotely through the port 22 we opened earlier in the security group. We will also attach the NIC we created and configured earlier with the Elasitc IP. Last but not least, we are going to have terraform perform some commands automatically on startup of our EC2 instance by having it update our package manager aptitude, install apache2 and auto approve the prompt, start the daemon using systemd, and then overwrite our starting index.html file with our super basic “This is my webserver” text.</p><div class="language-terraform highlighter-rouge"><div class="code-header"> <span data-label-text="Terraform"><i class="fas fa-code small"></i></span> <button aria-label="copy" data-title-succeed="Copied!"><i class="far fa-clipboard"></i></button></div><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
4
5
6
7
8
9
10
11
12
13
14
15
16
17
18
19
20
21
22
23
</pre><td class="rouge-code"><pre><span class="k">resource</span> <span class="s2">"aws_instance"</span> <span class="s2">"web-server-instance"</span> <span class="p">{</span>
  <span class="nx">ami</span>           <span class="p">=</span> <span class="s2">"ami-07d02ee1eeb0c996c"</span>
  <span class="nx">instance_type</span> <span class="p">=</span> <span class="s2">"t2.micro"</span>
  <span class="nx">availability_zone</span> <span class="p">=</span> <span class="s2">"us-east-1a"</span>
  <span class="nx">key_name</span> <span class="p">=</span> <span class="s2">"terraform-aws-key"</span>

  <span class="nx">network_interface</span> <span class="p">{</span>
    <span class="nx">device_index</span> <span class="p">=</span> <span class="mi">0</span>
    <span class="nx">network_interface_id</span> <span class="p">=</span> <span class="nx">aws_network_interface</span><span class="p">.</span><span class="nx">web</span><span class="err">-</span><span class="nx">server</span><span class="err">-</span><span class="nx">nic</span><span class="p">.</span><span class="nx">id</span>
  <span class="p">}</span>

  <span class="nx">user_data</span> <span class="p">=</span> <span class="o">&lt;&lt;-</span><span class="no">EOF</span><span class="sh">
        #!/bin/bash
        sudo apt update -y
        sudo apt install apache2 -y
        sudo systemctl start apache2
        sudo bash -c 'echo This is my webserver &gt; /var/www/html/index.html'
</span><span class="no">        EOF

</span>  <span class="nx">tags</span> <span class="p">=</span> <span class="p">{</span>
    <span class="nx">Name</span> <span class="p">=</span> <span class="s2">"web-server-instance"</span>
  <span class="p">}</span>
<span class="p">}</span>
</pre></table></code></div></div><h1 id="terraform-plan">Terraform Plan</h1><p>All the pieces are in place. Now it’s time to start watching the magic happen with the following command:</p><div class="language-bash highlighter-rouge"><div class="code-header"> <span data-label-text="Shell"><i class="fas fa-code small"></i></span> <button aria-label="copy" data-title-succeed="Copied!"><i class="far fa-clipboard"></i></button></div><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
</pre><td class="rouge-code"><pre>terraform plan
</pre></table></code></div></div><p>This will go through a dry run of what changes will be implemented if the current start of our terraform file will be deployed based on what the existing state of current infrastructure is. At the moment, since we have not deployed anything yet, we will see the following output:</p><div class="language-bash highlighter-rouge"><div class="code-header"> <span data-label-text="Shell"><i class="fas fa-code small"></i></span> <button aria-label="copy" data-title-succeed="Copied!"><i class="far fa-clipboard"></i></button></div><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
</pre><td class="rouge-code"><pre>Plan: 9 to add, 0 to change, 0 to destroy.
</pre></table></code></div></div><h1 id="terraform-apply">Terraform Apply</h1><p>Everything is looking good! I can review than pending changes and send it on it’s way when I am satisfied with the following command:</p><div class="language-bash highlighter-rouge"><div class="code-header"> <span data-label-text="Shell"><i class="fas fa-code small"></i></span> <button aria-label="copy" data-title-succeed="Copied!"><i class="far fa-clipboard"></i></button></div><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
</pre><td class="rouge-code"><pre>terraform apply
</pre></table></code></div></div><p>You will once again be prompted of the changes and a detailed list of those changes to once again review. A manual user input is required to continue by entering “yes”.</p><div class="language-bash highlighter-rouge"><div class="code-header"> <span data-label-text="Shell"><i class="fas fa-code small"></i></span> <button aria-label="copy" data-title-succeed="Copied!"><i class="far fa-clipboard"></i></button></div><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
4
5
6
7
</pre><td class="rouge-code"><pre>Plan: 9 to add, 0 to change, 0 to destroy.

Do you want to perform these actions?
  Terraform will perform the actions described above.
  Only <span class="s1">'yes'</span> will be accepted to approve.

  Enter a value:
</pre></table></code></div></div><p>The following output will result in a successful deploy of our AWS infrastructure defined in our terraform.</p><div class="language-bash highlighter-rouge"><div class="code-header"> <span data-label-text="Shell"><i class="fas fa-code small"></i></span> <button aria-label="copy" data-title-succeed="Copied!"><i class="far fa-clipboard"></i></button></div><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
4
5
6
7
8
9
10
11
12
13
14
15
16
17
18
19
20
21
22
</pre><td class="rouge-code"><pre>aws_vpc.prod-vpc: Creating...
aws_vpc.prod-vpc: Creation <span class="nb">complete </span>after 2s <span class="o">[</span><span class="nb">id</span><span class="o">=</span>vpc-01477f886e172762b]
aws_internet_gateway.gw: Creating...
aws_subnet.subnet-1: Creating...
aws_security_group.allow_web: Creating...
aws_internet_gateway.gw: Creation <span class="nb">complete </span>after 1s <span class="o">[</span><span class="nb">id</span><span class="o">=</span>igw-0e4d81991a308a8a2]
aws_route_table.prod-route-table: Creating...
aws_subnet.subnet-1: Creation <span class="nb">complete </span>after 1s <span class="o">[</span><span class="nb">id</span><span class="o">=</span>subnet-0480fd0a6ab8e5593]
aws_route_table.prod-route-table: Creation <span class="nb">complete </span>after 2s <span class="o">[</span><span class="nb">id</span><span class="o">=</span>rtb-0b7d8e33ef8f17370]
aws_route_table_association.a: Creating...
aws_route_table_association.a: Creation <span class="nb">complete </span>after 1s <span class="o">[</span><span class="nb">id</span><span class="o">=</span>rtbassoc-0969419db4a5db64a]
aws_security_group.allow_web: Creation <span class="nb">complete </span>after 4s <span class="o">[</span><span class="nb">id</span><span class="o">=</span>sg-041a669fc2ae109b4]
aws_network_interface.web-server-nic: Creating...
aws_network_interface.web-server-nic: Creation <span class="nb">complete </span>after 1s <span class="o">[</span><span class="nb">id</span><span class="o">=</span>eni-07a1016a60e537708]
aws_eip.one: Creating...
aws_instance.web-server-instance: Creating...
aws_eip.one: Creation <span class="nb">complete </span>after 2s <span class="o">[</span><span class="nb">id</span><span class="o">=</span>eipalloc-09f476c9598eb40bb]
aws_instance.web-server-instance: Still creating... <span class="o">[</span>10s elapsed]
aws_instance.web-server-instance: Still creating... <span class="o">[</span>20s elapsed]
aws_instance.web-server-instance: Creation <span class="nb">complete </span>after 24s <span class="o">[</span><span class="nb">id</span><span class="o">=</span>i-037bdb9db1dcedfad]

Apply <span class="nb">complete</span><span class="o">!</span> Resources: 9 added, 0 changed, 0 destroyed.
</pre></table></code></div></div><h1 id="checking-the-results">Checking the Results</h1><p>Now our terraform is setup to configure our AWS innfrastructure exactly how we want it. It will take only a few moments to configure and it will all be deployed automatically. Best of all our environment will be exactly the same each time without errors (unless of course if you made any mistakes in the .tf file itself).</p><p>We can view the results on the AWS Console.</p><blockquote class="prompt-info"><div><p>Info: This EC2 instance and the AWS Account are only temporary. This information will not be used by me in the time of publishing.</p></div></blockquote><p><img data-src="/project-assets/TerraformWithAWS/aws-instance-running.png" alt="AWS Instance Running" data-proofer-ignore></p><p><img data-src="/project-assets/TerraformWithAWS/ec2-instance-details.png" alt="AWS Instance Details" data-proofer-ignore></p><p>We can test the result by visiting the public IP Elastic IP that was assigned.</p><p><img data-src="/project-assets/TerraformWithAWS/this-is-my-webserver.png" alt="This is my Webserver" data-proofer-ignore></p><h1 id="terraform-destory">Terraform Destory</h1><p>Of course what goes up, must come down. Well, not “must”; but if you need to tear down everything that was just deployed using terraform, we can use the following command to spin down the infrastructure.</p><div class="language-bash highlighter-rouge"><div class="code-header"> <span data-label-text="Shell"><i class="fas fa-code small"></i></span> <button aria-label="copy" data-title-succeed="Copied!"><i class="far fa-clipboard"></i></button></div><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
</pre><td class="rouge-code"><pre>terraform destroy
</pre></table></code></div></div><p>You will a detailed list of all the resources that will destroyed with this command. If everything looks as desired, a manual entry of the keyword “yes” will be required.</p><div class="language-bash highlighter-rouge"><div class="code-header"> <span data-label-text="Shell"><i class="fas fa-code small"></i></span> <button aria-label="copy" data-title-succeed="Copied!"><i class="far fa-clipboard"></i></button></div><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
4
5
6
7
</pre><td class="rouge-code"><pre>Plan: 0 to add, 0 to change, 9 to destroy.

Do you really want to destroy all resources?
  Terraform will destroy all your managed infrastructure, as shown above.
  There is no undo. Only <span class="s1">'yes'</span> will be accepted to confirm.

  Enter a value:
</pre></table></code></div></div><p>After tying “yes” and pressing enter, you will see the following output that your resources were successfully destroyed.</p><div class="language-bash highlighter-rouge"><div class="code-header"> <span data-label-text="Shell"><i class="fas fa-code small"></i></span> <button aria-label="copy" data-title-succeed="Copied!"><i class="far fa-clipboard"></i></button></div><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
4
5
6
7
8
9
10
11
12
13
14
15
16
17
18
19
20
21
22
23
</pre><td class="rouge-code"><pre>aws_route_table_association.a: Destroying... <span class="o">[</span><span class="nb">id</span><span class="o">=</span>rtbassoc-0969419db4a5db64a]
aws_eip.one: Destroying... <span class="o">[</span><span class="nb">id</span><span class="o">=</span>eipalloc-09f476c9598eb40bb]
aws_instance.web-server-instance: Destroying... <span class="o">[</span><span class="nb">id</span><span class="o">=</span>i-037bdb9db1dcedfad]
aws_route_table_association.a: Destruction <span class="nb">complete </span>after 0s
aws_route_table.prod-route-table: Destroying... <span class="o">[</span><span class="nb">id</span><span class="o">=</span>rtb-0b7d8e33ef8f17370]
aws_route_table.prod-route-table: Destruction <span class="nb">complete </span>after 1s
aws_eip.one: Destruction <span class="nb">complete </span>after 2s
aws_internet_gateway.gw: Destroying... <span class="o">[</span><span class="nb">id</span><span class="o">=</span>igw-0e4d81991a308a8a2]
aws_internet_gateway.gw: Destruction <span class="nb">complete </span>after 1s
aws_instance.web-server-instance: Still destroying... <span class="o">[</span><span class="nb">id</span><span class="o">=</span>i-037bdb9db1dcedfad, 10s elapsed]
aws_instance.web-server-instance: Still destroying... <span class="o">[</span><span class="nb">id</span><span class="o">=</span>i-037bdb9db1dcedfad, 20s elapsed]
aws_instance.web-server-instance: Still destroying... <span class="o">[</span><span class="nb">id</span><span class="o">=</span>i-037bdb9db1dcedfad, 30s elapsed]
aws_instance.web-server-instance: Destruction <span class="nb">complete </span>after 31s
aws_network_interface.web-server-nic: Destroying... <span class="o">[</span><span class="nb">id</span><span class="o">=</span>eni-07a1016a60e537708]
aws_network_interface.web-server-nic: Destruction <span class="nb">complete </span>after 0s
aws_subnet.subnet-1: Destroying... <span class="o">[</span><span class="nb">id</span><span class="o">=</span>subnet-0480fd0a6ab8e5593]
aws_security_group.allow_web: Destroying... <span class="o">[</span><span class="nb">id</span><span class="o">=</span>sg-041a669fc2ae109b4]
aws_subnet.subnet-1: Destruction <span class="nb">complete </span>after 1s
aws_security_group.allow_web: Destruction <span class="nb">complete </span>after 1s
aws_vpc.prod-vpc: Destroying... <span class="o">[</span><span class="nb">id</span><span class="o">=</span>vpc-01477f886e172762b]
aws_vpc.prod-vpc: Destruction <span class="nb">complete </span>after 1s

Destroy <span class="nb">complete</span><span class="o">!</span> Resources: 9 destroyed.
</pre></table></code></div></div><h1 id="completed-maintf-file">Completed main.tf File</h1><p>At the end of all this, your main.tf file will come together to look like the following:</p><h3 id="maintf"><span class="mr-2">main.tf</span><a href="#maintf" class="anchor text-muted"><i class="fas fa-hashtag"></i></a></h3><div class="language-terraform highlighter-rouge"><div class="code-header"> <span data-label-text="Terraform"><i class="fas fa-code small"></i></span> <button aria-label="copy" data-title-succeed="Copied!"><i class="far fa-clipboard"></i></button></div><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
4
5
6
7
8
9
10
11
12
13
14
15
16
17
18
19
20
21
22
23
24
25
26
27
28
29
30
31
32
33
34
35
36
37
38
39
40
41
42
43
44
45
46
47
48
49
50
51
52
53
54
55
56
57
58
59
60
61
62
63
64
65
66
67
68
69
70
71
72
73
74
75
76
77
78
79
80
81
82
83
84
85
86
87
88
89
90
91
92
93
94
95
96
97
98
99
100
101
102
103
104
105
106
107
108
109
110
111
112
113
114
115
116
117
118
119
120
121
122
123
124
125
126
127
128
129
130
131
132
133
134
</pre><td class="rouge-code"><pre><span class="k">provider</span> <span class="s2">"aws"</span> <span class="p">{</span>
  <span class="nx">region</span> <span class="p">=</span> <span class="s2">"us-east-1"</span>
  <span class="nx">access_key</span> <span class="p">=</span> <span class="s2">"&lt;YOUR-ACCESS-KEY&gt;"</span>
  <span class="nx">secret_key</span> <span class="p">=</span> <span class="s2">"&lt;YOUR-SECRET-KEY&gt;"</span>
<span class="p">}</span>

<span class="k">resource</span> <span class="s2">"aws_vpc"</span> <span class="s2">"prod-vpc"</span> <span class="p">{</span>
  <span class="nx">cidr_block</span>       <span class="p">=</span> <span class="s2">"10.0.0.0/16"</span>
  <span class="nx">instance_tenancy</span> <span class="p">=</span> <span class="s2">"default"</span>
  <span class="nx">tags</span> <span class="p">=</span> <span class="p">{</span>
    <span class="nx">Name</span> <span class="p">=</span> <span class="s2">"production"</span>
  <span class="p">}</span>
<span class="p">}</span>

<span class="k">resource</span> <span class="s2">"aws_internet_gateway"</span> <span class="s2">"gw"</span> <span class="p">{</span>
  <span class="nx">vpc_id</span> <span class="p">=</span> <span class="nx">aws_vpc</span><span class="p">.</span><span class="nx">prod</span><span class="err">-</span><span class="nx">vpc</span><span class="p">.</span><span class="nx">id</span>
<span class="p">}</span>

<span class="k">resource</span> <span class="s2">"aws_subnet"</span> <span class="s2">"subnet-1"</span> <span class="p">{</span>
  <span class="nx">vpc_id</span>     <span class="p">=</span> <span class="nx">aws_vpc</span><span class="p">.</span><span class="nx">prod</span><span class="err">-</span><span class="nx">vpc</span><span class="p">.</span><span class="nx">id</span>
  <span class="nx">cidr_block</span> <span class="p">=</span> <span class="s2">"10.0.1.0/24"</span>
  <span class="nx">availability_zone</span> <span class="p">=</span> <span class="s2">"us-east-1a"</span>
  
  <span class="nx">tags</span> <span class="p">=</span> <span class="p">{</span>
    <span class="nx">Name</span> <span class="p">=</span> <span class="s2">"prod-subnet"</span>
  <span class="p">}</span>
<span class="p">}</span>

<span class="k">resource</span> <span class="s2">"aws_route_table"</span> <span class="s2">"prod-route-table"</span> <span class="p">{</span>
  <span class="nx">vpc_id</span> <span class="p">=</span> <span class="nx">aws_vpc</span><span class="p">.</span><span class="nx">prod</span><span class="err">-</span><span class="nx">vpc</span><span class="p">.</span><span class="nx">id</span>

  <span class="nx">route</span> <span class="p">{</span>
    <span class="nx">cidr_block</span> <span class="p">=</span> <span class="s2">"0.0.0.0/0"</span>
    <span class="nx">gateway_id</span> <span class="p">=</span> <span class="nx">aws_internet_gateway</span><span class="p">.</span><span class="nx">gw</span><span class="p">.</span><span class="nx">id</span>
  <span class="p">}</span>

  <span class="nx">route</span> <span class="p">{</span>
    <span class="nx">ipv6_cidr_block</span>        <span class="p">=</span> <span class="s2">"::/0"</span>
    <span class="nx">gateway_id</span> <span class="p">=</span> <span class="nx">aws_internet_gateway</span><span class="p">.</span><span class="nx">gw</span><span class="p">.</span><span class="nx">id</span>
  <span class="p">}</span>

  <span class="nx">tags</span> <span class="p">=</span> <span class="p">{</span>
    <span class="nx">Name</span> <span class="p">=</span> <span class="s2">"production"</span>
  <span class="p">}</span>
<span class="p">}</span>

<span class="k">resource</span> <span class="s2">"aws_route_table_association"</span> <span class="s2">"a"</span> <span class="p">{</span>
  <span class="nx">subnet_id</span>      <span class="p">=</span> <span class="nx">aws_subnet</span><span class="p">.</span><span class="nx">subnet</span><span class="err">-</span><span class="mi">1</span><span class="p">.</span><span class="nx">id</span>
  <span class="nx">route_table_id</span> <span class="p">=</span> <span class="nx">aws_route_table</span><span class="p">.</span><span class="nx">prod</span><span class="err">-</span><span class="nx">route</span><span class="err">-</span><span class="nx">table</span><span class="p">.</span><span class="nx">id</span>
<span class="p">}</span>

<span class="k">resource</span> <span class="s2">"aws_security_group"</span> <span class="s2">"allow_web"</span> <span class="p">{</span>
  <span class="nx">name</span>        <span class="p">=</span> <span class="s2">"allow_web_traffic"</span>
  <span class="nx">description</span> <span class="p">=</span> <span class="s2">"Allow Web inbound traffic"</span>
  <span class="nx">vpc_id</span>      <span class="p">=</span> <span class="nx">aws_vpc</span><span class="p">.</span><span class="nx">prod</span><span class="err">-</span><span class="nx">vpc</span><span class="p">.</span><span class="nx">id</span>

  <span class="nx">ingress</span> <span class="p">{</span>
    <span class="nx">description</span>      <span class="p">=</span> <span class="s2">"HTTP"</span>
    <span class="nx">from_port</span>        <span class="p">=</span> <span class="mi">80</span>
    <span class="nx">to_port</span>          <span class="p">=</span> <span class="mi">80</span>
    <span class="nx">protocol</span>         <span class="p">=</span> <span class="s2">"tcp"</span>
    <span class="nx">cidr_blocks</span>      <span class="p">=</span> <span class="p">[</span><span class="s2">"0.0.0.0/0"</span><span class="p">]</span>
    <span class="nx">ipv6_cidr_blocks</span> <span class="p">=</span> <span class="p">[</span><span class="s2">"::/0"</span><span class="p">]</span>
  <span class="p">}</span>

<span class="nx">ingress</span> <span class="p">{</span>
    <span class="nx">description</span>      <span class="p">=</span> <span class="s2">"HTTPS"</span>
    <span class="nx">from_port</span>        <span class="p">=</span> <span class="mi">443</span>
    <span class="nx">to_port</span>          <span class="p">=</span> <span class="mi">443</span>
    <span class="nx">protocol</span>         <span class="p">=</span> <span class="s2">"tcp"</span>
    <span class="nx">cidr_blocks</span>      <span class="p">=</span> <span class="p">[</span><span class="s2">"0.0.0.0/0"</span><span class="p">]</span>
    <span class="nx">ipv6_cidr_blocks</span> <span class="p">=</span> <span class="p">[</span><span class="s2">"::/0"</span><span class="p">]</span>
  <span class="p">}</span>

<span class="nx">ingress</span> <span class="p">{</span>
    <span class="nx">description</span>      <span class="p">=</span> <span class="s2">"SSH"</span>
    <span class="nx">from_port</span>        <span class="p">=</span> <span class="mi">22</span>
    <span class="nx">to_port</span>          <span class="p">=</span> <span class="mi">22</span>
    <span class="nx">protocol</span>         <span class="p">=</span> <span class="s2">"tcp"</span>
    <span class="nx">cidr_blocks</span>      <span class="p">=</span> <span class="p">[</span><span class="s2">"0.0.0.0/0"</span><span class="p">]</span>
    <span class="nx">ipv6_cidr_blocks</span> <span class="p">=</span> <span class="p">[</span><span class="s2">"::/0"</span><span class="p">]</span>
  <span class="p">}</span>

  <span class="nx">egress</span> <span class="p">{</span>
    <span class="nx">from_port</span>        <span class="p">=</span> <span class="mi">0</span>
    <span class="nx">to_port</span>          <span class="p">=</span> <span class="mi">0</span>
    <span class="nx">protocol</span>         <span class="p">=</span> <span class="s2">"-1"</span>
    <span class="nx">cidr_blocks</span>      <span class="p">=</span> <span class="p">[</span><span class="s2">"0.0.0.0/0"</span><span class="p">]</span>
    <span class="nx">ipv6_cidr_blocks</span> <span class="p">=</span> <span class="p">[</span><span class="s2">"::/0"</span><span class="p">]</span>
  <span class="p">}</span>

  <span class="nx">tags</span> <span class="p">=</span> <span class="p">{</span>
    <span class="nx">Name</span> <span class="p">=</span> <span class="s2">"allow_web_also_ssh"</span>
  <span class="p">}</span>
<span class="p">}</span>

<span class="k">resource</span> <span class="s2">"aws_network_interface"</span> <span class="s2">"web-server-nic"</span> <span class="p">{</span>
  <span class="nx">subnet_id</span>       <span class="p">=</span> <span class="nx">aws_subnet</span><span class="p">.</span><span class="nx">subnet</span><span class="err">-</span><span class="mi">1</span><span class="p">.</span><span class="nx">id</span>
  <span class="nx">private_ips</span>     <span class="p">=</span> <span class="p">[</span><span class="s2">"10.0.1.50"</span><span class="p">]</span>
  <span class="nx">security_groups</span> <span class="p">=</span> <span class="p">[</span><span class="nx">aws_security_group</span><span class="p">.</span><span class="nx">allow_web</span><span class="p">.</span><span class="nx">id</span><span class="p">]</span>
<span class="p">}</span>

<span class="k">resource</span> <span class="s2">"aws_eip"</span> <span class="s2">"one"</span> <span class="p">{</span>
  <span class="nx">vpc</span>                       <span class="p">=</span> <span class="kc">true</span>
  <span class="nx">network_interface</span>         <span class="p">=</span> <span class="nx">aws_network_interface</span><span class="p">.</span><span class="nx">web</span><span class="err">-</span><span class="nx">server</span><span class="err">-</span><span class="nx">nic</span><span class="p">.</span><span class="nx">id</span>
  <span class="nx">associate_with_private_ip</span> <span class="p">=</span> <span class="s2">"10.0.1.50"</span>
  <span class="nx">depends_on</span> <span class="p">=</span> <span class="p">[</span>
    <span class="nx">aws_internet_gateway</span><span class="p">.</span><span class="nx">gw</span>
  <span class="p">]</span>
<span class="p">}</span>

<span class="k">resource</span> <span class="s2">"aws_instance"</span> <span class="s2">"web-server-instance"</span> <span class="p">{</span>
  <span class="nx">ami</span>           <span class="p">=</span> <span class="s2">"ami-07d02ee1eeb0c996c"</span>
  <span class="nx">instance_type</span> <span class="p">=</span> <span class="s2">"t2.micro"</span>
  <span class="nx">availability_zone</span> <span class="p">=</span> <span class="s2">"us-east-1a"</span>
  <span class="nx">key_name</span> <span class="p">=</span> <span class="s2">"terraform-aws-key"</span>

  <span class="nx">network_interface</span> <span class="p">{</span>
    <span class="nx">device_index</span> <span class="p">=</span> <span class="mi">0</span>
    <span class="nx">network_interface_id</span> <span class="p">=</span> <span class="nx">aws_network_interface</span><span class="p">.</span><span class="nx">web</span><span class="err">-</span><span class="nx">server</span><span class="err">-</span><span class="nx">nic</span><span class="p">.</span><span class="nx">id</span>
  <span class="p">}</span>

  <span class="nx">user_data</span> <span class="p">=</span> <span class="o">&lt;&lt;-</span><span class="no">EOF</span><span class="sh">
        #!/bin/bash
        sudo apt update -y
        sudo apt install apache2 -y
        sudo systemctl start apache2
        sudo bash -c 'echo This is my webserver &gt; /var/www/html/index.html'
</span><span class="no">        EOF

</span>  <span class="nx">tags</span> <span class="p">=</span> <span class="p">{</span>
    <span class="nx">Name</span> <span class="p">=</span> <span class="s2">"web-server-instance"</span>
  <span class="p">}</span>
<span class="p">}</span>
</pre></table></code></div></div></div><div class="post-tail-wrapper text-muted"><div class="post-meta mb-3"> <i class="far fa-folder-open fa-fw mr-1"></i> <a href='/categories/infrastructure-as-code/'>Infrastructure as Code</a>, <a href='/categories/terraform/'>Terraform</a></div><div class="post-tags"> <i class="fa fa-tags fa-fw mr-1"></i> <a href="/tags/terraform/" class="post-tag no-text-decoration" >terraform</a> <a href="/tags/ec2/" class="post-tag no-text-decoration" >ec2</a> <a href="/tags/aws/" class="post-tag no-text-decoration" >aws</a> <a href="/tags/automation/" class="post-tag no-text-decoration" >automation</a> <a href="/tags/vpc/" class="post-tag no-text-decoration" >vpc</a></div><div class="post-tail-bottom d-flex justify-content-between align-items-center mt-3 pt-5 pb-2"><div class="license-wrapper"> This post is licensed under <a href="https://creativecommons.org/licenses/by/4.0/"> CC BY 4.0 </a> by the author.</div><div class="share-wrapper"> <span class="share-label text-muted mr-1">Share</span> <span class="share-icons"> <a href="https://twitter.com/intent/tweet?text=Automating+AWS+VPC+and+EC2+Instances+using+Terraform+-+OchoaProjects&url=https%3A%2F%2Fochoaprojects.github.io%2Fposts%2FTerraformWithAWS%2F" data-toggle="tooltip" data-placement="top" title="Twitter" target="_blank" rel="noopener" aria-label="Twitter"> <i class="fa-fw fab fa-twitter"></i> </a> <a href="https://www.facebook.com/sharer/sharer.php?title=Automating+AWS+VPC+and+EC2+Instances+using+Terraform+-+OchoaProjects&u=https%3A%2F%2Fochoaprojects.github.io%2Fposts%2FTerraformWithAWS%2F" data-toggle="tooltip" data-placement="top" title="Facebook" target="_blank" rel="noopener" aria-label="Facebook"> <i class="fa-fw fab fa-facebook-square"></i> </a> <a href="https://t.me/share/url?url=https%3A%2F%2Fochoaprojects.github.io%2Fposts%2FTerraformWithAWS%2F&text=Automating+AWS+VPC+and+EC2+Instances+using+Terraform+-+OchoaProjects" data-toggle="tooltip" data-placement="top" title="Telegram" target="_blank" rel="noopener" aria-label="Telegram"> <i class="fa-fw fab fa-telegram"></i> </a> <i id="copy-link" class="fa-fw fas fa-link small" data-toggle="tooltip" data-placement="top" title="Copy link" data-title-succeed="Link copied successfully!"> </i> </span></div></div></div></div></div><div id="panel-wrapper" class="col-xl-3 pl-2 text-muted"><div class="access"><div id="access-lastmod" class="post"><div class="panel-heading">Recently Updated</div><ul class="post-content pl-0 pb-1 ml-1 mt-2"><li><a href="/posts/ProxMoxSetupInstall/">ProxMox Setup and Installation</a><li><a href="/posts/AboutMeAndTopology/">About Me and Homelab Topology</a><li><a href="/posts/PlexAutomation/">Plex Automation</a><li><a href="/posts/ProxMoxCloudInitImage/">Create a Debian Cloud-Init Template on Proxmox</a><li><a href="/posts/ProvisionDockerWithAnsible/">Provision a Linux Server With Docker Using Ansible</a></ul></div><div id="access-tags"><div class="panel-heading">Trending Tags</div><div class="d-flex flex-wrap mt-3 mb-1 mr-3"> <a class="post-tag" href="/tags/automation/">automation</a> <a class="post-tag" href="/tags/aws/">aws</a> <a class="post-tag" href="/tags/docker/">docker</a> <a class="post-tag" href="/tags/python/">python</a> <a class="post-tag" href="/tags/proxmox/">proxmox</a> <a class="post-tag" href="/tags/terraform/">terraform</a> <a class="post-tag" href="/tags/cloudinit/">cloudinit</a> <a class="post-tag" href="/tags/containers/">containers</a> <a class="post-tag" href="/tags/ec2/">ec2</a> <a class="post-tag" href="/tags/kubernetes/">kubernetes</a></div></div></div><script src="https://cdn.jsdelivr.net/gh/afeld/bootstrap-toc@1.0.1/dist/bootstrap-toc.min.js"></script><div id="toc-wrapper" class="pl-0 pr-4 mb-5"><div class="panel-heading pl-3 pt-2 mb-2">Contents</div><nav id="toc" data-toggle="toc"></nav></div></div></div><div class="row"><div id="tail-wrapper" class="col-12 col-lg-11 col-xl-9 pl-3 pr-3 pr-xl-4"><div id="related-posts" class="mt-5 mb-2 mb-sm-4"><h3 class="pt-2 mt-1 mb-4 ml-1" data-toc-skip>Further Reading</h3><div class="card-deck mb-4"><div class="card"> <a href="/posts/UsingAWSLambdaWithAPIGateway/"><div class="card-body"> <em class="small" data-ts="1658768400" data-df="ll" > Jul 25, 2022 </em><h3 class="pt-0 mt-1 mb-3" data-toc-skip>Using AWS Lambda and API Gateway to Check URLs</h3><div class="text-muted small"><p> Using AWS Lambda Python functions and an API Gateway to deploy a URL Checker that looks for known malicious websites all while being serveless through Amazon Web Services. Table of Contents Ov...</p></div></div></a></div><div class="card"> <a href="/posts/DeployingVMsWithTerraformInProxMox/"><div class="card-body"> <em class="small" data-ts="1654448400" data-df="ll" > Jun 5, 2022 </em><h3 class="pt-0 mt-1 mb-3" data-toc-skip>Deploying VMs With Terraform In ProxMox</h3><div class="text-muted small"><p> Leveraging our ProxMox cloud-init templates to deploy VMs entirely through Terraform quickly and easily. Table of Contents Prep a cloud-init template to use with Terraform Install qe...</p></div></div></a></div><div class="card"> <a href="/posts/SessionManagerAWS/"><div class="card-body"> <em class="small" data-ts="1664902800" data-df="ll" > Oct 4, 2022 </em><h3 class="pt-0 mt-1 mb-3" data-toc-skip>Session Manager for AWS</h3><div class="text-muted small"><p> Session Manager is the useful AWS tool that you might not be thinking about. If you’ve ever run something like ProxMox you understand just how handy it is to be able to click “console” for any of y...</p></div></div></a></div></div></div><div class="post-navigation d-flex justify-content-between"> <a href="/posts/CheckS3BucketsWithLambdaFunction/" class="btn btn-outline-primary" prompt="Older"><p>Checking AWS S3 Buckets With Python Lambda Function</p></a> <a href="/posts/ProxMoxSetupInstall/" class="btn btn-outline-primary" prompt="Newer"><p>ProxMox Setup and Installation</p></a></div></div></div><footer class="row pl-3 pr-3"><div class="col-12 d-flex justify-content-between align-items-center text-muted pl-0 pr-0"><div class="footer-left"><p class="mb-0"> © 2023 <a href="https://github.com/ochoaprojects">Brandon Ochoa</a>. <span data-toggle="tooltip" data-placement="top" title="Except where otherwise noted, the blog posts on this site are licensed under the Creative Commons Attribution 4.0 International (CC BY 4.0) License by the author.">Some rights reserved.</span></p></div><div class="footer-right"><p class="mb-0"> Powered by <a href="https://jekyllrb.com" target="_blank" rel="noopener">Jekyll</a> hosted on Github</p></div></div></footer></div><div id="search-result-wrapper" class="d-flex justify-content-center unloaded"><div class="col-12 col-sm-11 post-content"><div id="search-hints"><div id="access-tags"><div class="panel-heading">Trending Tags</div><div class="d-flex flex-wrap mt-3 mb-1 mr-3"> <a class="post-tag" href="/tags/automation/">automation</a> <a class="post-tag" href="/tags/aws/">aws</a> <a class="post-tag" href="/tags/docker/">docker</a> <a class="post-tag" href="/tags/python/">python</a> <a class="post-tag" href="/tags/proxmox/">proxmox</a> <a class="post-tag" href="/tags/terraform/">terraform</a> <a class="post-tag" href="/tags/cloudinit/">cloudinit</a> <a class="post-tag" href="/tags/containers/">containers</a> <a class="post-tag" href="/tags/ec2/">ec2</a> <a class="post-tag" href="/tags/kubernetes/">kubernetes</a></div></div></div><div id="search-results" class="d-flex flex-wrap justify-content-center text-muted mt-3"></div></div></div></div><div id="mask"></div><a id="back-to-top" href="#" aria-label="back-to-top" class="btn btn-lg btn-box-shadow" role="button"> <i class="fas fa-angle-up"></i> </a><div id="notification" class="toast" role="alert" aria-live="assertive" aria-atomic="true" data-animation="true" data-autohide="false"><div class="toast-header"> <button type="button" class="ml-2 ml-auto close" data-dismiss="toast" aria-label="Close"> <span aria-hidden="true">&times;</span> </button></div><div class="toast-body text-center pt-0"><p class="pl-2 pr-2 mb-3">A new version of content is available.</p><button type="button" class="btn btn-primary" aria-label="Update"> Update </button></div></div><script src="https://cdn.jsdelivr.net/npm/simple-jekyll-search@1.10.0/dest/simple-jekyll-search.min.js"></script> <script> SimpleJekyllSearch({ searchInput: document.getElementById('search-input'), resultsContainer: document.getElementById('search-results'), json: '/assets/js/data/search.json', searchResultTemplate: '<div class="pl-1 pr-1 pl-sm-2 pr-sm-2 pl-lg-4 pr-lg-4 pl-xl-0 pr-xl-0"> <a href="{url}">{title}</a><div class="post-meta d-flex flex-column flex-sm-row text-muted mt-1 mb-1"> {categories} {tags}</div><p>{snippet}</p></div>', noResultsText: '<p class="mt-5">Oops! No results found.</p>', templateMiddleware: function(prop, value, template) { if (prop === 'categories') { if (value === '') { return `${value}`; } else { return `<div class="mr-sm-4"><i class="far fa-folder fa-fw"></i>${value}</div>`; } } if (prop === 'tags') { if (value === '') { return `${value}`; } else { return `<div><i class="fa fa-tag fa-fw"></i>${value}</div>`; } } } }); </script> <script src="https://cdn.jsdelivr.net/combine/npm/magnific-popup@1/dist/jquery.magnific-popup.min.js,npm/lozad/dist/lozad.min.js,npm/clipboard@2/dist/clipboard.min.js"></script> <script src="https://cdn.jsdelivr.net/combine/npm/dayjs@1/dayjs.min.js,npm/dayjs@1/locale/en.min.js,npm/dayjs@1/plugin/relativeTime.min.js,npm/dayjs@1/plugin/localizedFormat.min.js"></script> <script defer src="/assets/js/dist/post.min.js"></script> <script src="https://cdn.jsdelivr.net/npm/bootstrap@4/dist/js/bootstrap.bundle.min.js"></script> <script defer src="/app.js"></script>
